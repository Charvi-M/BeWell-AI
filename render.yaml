services:
- type: web
  name: BeWell-AI
  env: python
  buildCommand: |
    # Force Python 3.10 usage
    python3.10 -m venv venv
    source venv/bin/activate
    pip install --upgrade pip
    pip install -r requirements.txt
  startCommand: |
    source venv/bin/activate
    export PYTHONUNBUFFERED=1
    export PYTHONDONTWRITEBYTECODE=1
    export TOKENIZERS_PARALLELISM=false
    gunicorn app:app \
      --workers 1 \
      --threads 2 \
      --bind 0.0.0.0:$PORT \
      --max-requests 500 \
      --max-requests-jitter 50 \
      --timeout 120 \
      --worker-class sync \
      --worker-tmp-dir /dev/shm \
      --preload
