services:
- type: web
  name: BeWell-AI
  env: python
  buildCommand: |
    pip install --no-cache-dir --upgrade pip setuptools wheel
    pip install --no-cache-dir -r requirements.txt
    python prepare_FAISS_vectorstore.py
  startCommand: |
    export PYTHONUNBUFFERED=1
    export PYTHONDONTWRITEBYTECODE=1
    export TOKENIZERS_PARALLELISM=false
    export OMP_NUM_THREADS=1
    export MALLOC_TRIM_THRESHOLD_=100000
    gunicorn app:app --workers 1 --threads 1 --bind 0.0.0.0:$PORT --max-requests 50 --max-requests-jitter 10 --timeout 300 --worker-class sync --worker-tmp-dir /dev/shm --preload --worker-connections 100